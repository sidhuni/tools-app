# 1. Identity and Version
clusterName: "elasticsearch"
nodeGroup: "master"
imageTag: "8.5.1"

# 2. FORCE SINGLE NODE (This is the most important part)
# This overrides the '3 replicas' and '2 minimum nodes' in your computed values
replicas: 1
minimumMasterNodes: 1
cluster:
  initial_master_nodes: [] # This stops the 'IllegalArgumentException'

extraEnvs:
  - name: "discovery.type"
    value: "single-node"

# 3. FIX FOR MAC RESOURCES
# Your computed values show 'hard' antiAffinity; we must disable it 
# because you only have one physical machine (your Mac).
antiAffinity: "soft"

resources:
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "1024Mi"
    cpu: "500m"

# IMPORTANT: You must also lower the Java Heap to fit inside the new limits
esJavaOpts: "-Xmx768m -Xms768m"

# 4. STORAGE (Reduced from 30Gi to 5Gi for local testing)
volumeClaimTemplate:
  accessModes: [ "ReadWriteOnce" ]
  resources:
    requests:
      storage: 5Gi

# 5. HEALTH CHECKS
# A 1-node cluster will NEVER be 'green' (it stays yellow). 
# We must change your computed 'green' to 'yellow'.
clusterHealthCheckParams: "wait_for_status=yellow&timeout=1s"

# 6. DISABLE PERMISSION ERRORS
# Rancher Desktop often blocks the sysctlInitContainer.
sysctlInitContainer:
  enabled: false


readinessProbe:
  failureThreshold: 3
  initialDelaySeconds: 120
  periodSeconds: 60
  timeoutSeconds: 5
