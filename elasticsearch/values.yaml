clusterName: "elasticsearch"
nodeGroup: "master"

image: "docker.elastic.co/elasticsearch/elasticsearch"
imageTag: "8.5.1"
imagePullPolicy: "IfNotPresent"

# Force single-node and disable memory lock (essential for Mac)
extraEnvs:
  - name: "discovery.type"
    value: "single-node"
  - name: "bootstrap.memory_lock"
    value: "false"

# This block is the 'Secret Sauce' that stops the Forbidden/Parse errors
cluster:
  initial_master_nodes: [] 

replicas: 1
minimumMasterNodes: null

# Resource limits (Elastic 8 needs 2Gi to boot)
resources:
  requests:
    cpu: "500m"
    memory: "2Gi"
  limits:
    cpu: "1000m"
    memory: "2Gi"

esJavaOpts: "-Xmx1g -Xms1g"

# Using local storage for Rancher Desktop
volumeClaimTemplate:
  accessModes: [ "ReadWriteOnce" ]
  resources:
    requests:
      storage: 5Gi

# Disable the problematic init container
sysctlInitContainer:
  enabled: false

# Acceptance criteria for a 1-node setup
clusterHealthCheckParams: "wait_for_status=yellow&timeout=1s"